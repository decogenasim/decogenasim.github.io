(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))a(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const q of d.addedNodes)q.tagName==="LINK"&&q.rel==="modulepreload"&&a(q)}).observe(document,{childList:!0,subtree:!0});function f(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(u){if(u.ep)return;u.ep=!0;const d=f(u);fetch(u.href,d)}})();function Me(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var fe={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var qe=fe.exports,Oe;function Pe(){return Oe||(Oe=1,(function(r,y){((f,a)=>{r.exports=a()})(qe,function f(){var a=typeof self<"u"?self:typeof window<"u"?window:a!==void 0?a:{},u,d=!a.document&&!!a.postMessage,q=a.IS_PAPA_WORKER||!1,le={},De=0,c={};function J(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var n=Ee(t);n.chunkSize=parseInt(n.chunkSize),t.step||t.chunk||(n.chunkSize=null),this._handle=new we(n),(this._handle.streamer=this)._config=n}).call(this,e),this.parseChunk=function(t,n){var s=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<s){let p=this._config.newline;p||(i=this._config.quoteChar||'"',p=this._handle.guessLineEndings(t,i)),t=[...t.split(p).slice(s)].join(p)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&(i=this._config.beforeFirstChunk(t))!==void 0&&(t=i),this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+t,i=(this._partialLine="",this._handle.parse(s,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=i.meta.cursor,s=(this._finished||(this._partialLine=s.substring(t-this._baseIndex),this._baseIndex=t),i&&i.data&&(this._rowCount+=i.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),q)a.postMessage({results:i,workerId:c.WORKER_ID,finished:s});else if(w(this._config.chunk)&&!n){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!s||!w(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(t){w(this._config.error)?this._config.error(t):q&&this._config.error&&a.postMessage({workerId:c.WORKER_ID,error:t,finished:!1})}}function ce(e){var t;(e=e||{}).chunkSize||(e.chunkSize=c.RemoteChunkSize),J.call(this,e),this._nextChunk=d?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(n){this._input=n,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),d||(t.onload=Z(this._chunkLoaded,this),t.onerror=Z(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!d),this._config.downloadRequestHeaders){var n,s=this._config.downloadRequestHeaders;for(n in s)t.setRequestHeader(n,s[n])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(p){this._chunkError(p.message)}d&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(n=>(n=n.getResponseHeader("Content-Range"))!==null?parseInt(n.substring(n.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(n){n=t.statusText||n,this._sendError(new Error(n))}}function de(e){(e=e||{}).chunkSize||(e.chunkSize=c.LocalChunkSize),J.call(this,e);var t,n,s=typeof FileReader<"u";this.stream=function(i){this._input=i,n=i.slice||i.webkitSlice||i.mozSlice,s?((t=new FileReader).onload=Z(this._chunkLoaded,this),t.onerror=Z(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var i=this._input,p=(this._config.chunkSize&&(p=Math.min(this._start+this._config.chunkSize,this._input.size),i=n.call(i,this._start,p)),t.readAsText(i,this._config.encoding));s||this._chunkLoaded({target:{result:p}})},this._chunkLoaded=function(i){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(i.target.result)},this._chunkError=function(){this._sendError(t.error)}}function re(e){var t;J.call(this,e=e||{}),this.stream=function(n){return t=n,this._nextChunk()},this._nextChunk=function(){var n,s;if(!this._finished)return n=this._config.chunkSize,t=n?(s=t.substring(0,n),t.substring(n)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function he(e){J.call(this,e=e||{});var t=[],n=!0,s=!1;this.pause=function(){J.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){J.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(i){this._input=i,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=Z(function(i){try{t.push(typeof i=="string"?i:i.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(p){this._streamError(p)}},this),this._streamError=Z(function(i){this._streamCleanUp(),this._sendError(i)},this),this._streamEnd=Z(function(){this._streamCleanUp(),s=!0,this._streamData("")},this),this._streamCleanUp=Z(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function we(e){var t,n,s,i,p=Math.pow(2,53),A=-p,B=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,H=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,_=this,I=0,l=0,j=!1,h=!1,E=[],o={data:[],errors:[],meta:{}};function T(k){return e.skipEmptyLines==="greedy"?k.join("").trim()==="":k.length===1&&k[0].length===0}function L(){if(o&&s&&(W("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),s=!1),e.skipEmptyLines&&(o.data=o.data.filter(function(x){return!T(x)})),P()){let x=function(F,R){w(e.transformHeader)&&(F=e.transformHeader(F,R)),E.push(F)};var g=x;if(o)if(Array.isArray(o.data[0])){for(var k=0;P()&&k<o.data.length;k++)o.data[k].forEach(x);o.data.splice(0,1)}else o.data.forEach(x)}function b(x,F){for(var R=e.header?{}:[],C=0;C<x.length;C++){var m=C,z=x[C],z=((v,S)=>(D=>(e.dynamicTypingFunction&&e.dynamicTyping[D]===void 0&&(e.dynamicTyping[D]=e.dynamicTypingFunction(D)),(e.dynamicTyping[D]||e.dynamicTyping)===!0))(v)?S==="true"||S==="TRUE"||S!=="false"&&S!=="FALSE"&&((D=>{if(B.test(D)&&(D=parseFloat(D),A<D&&D<p))return 1})(S)?parseFloat(S):H.test(S)?new Date(S):S===""?null:S):S)(m=e.header?C>=E.length?"__parsed_extra":E[C]:m,z=e.transform?e.transform(z,m):z);m==="__parsed_extra"?(R[m]=R[m]||[],R[m].push(z)):R[m]=z}return e.header&&(C>E.length?W("FieldMismatch","TooManyFields","Too many fields: expected "+E.length+" fields but parsed "+C,l+F):C<E.length&&W("FieldMismatch","TooFewFields","Too few fields: expected "+E.length+" fields but parsed "+C,l+F)),R}var O;o&&(e.header||e.dynamicTyping||e.transform)&&(O=1,!o.data.length||Array.isArray(o.data[0])?(o.data=o.data.map(b),O=o.data.length):o.data=b(o.data,0),e.header&&o.meta&&(o.meta.fields=E),l+=O)}function P(){return e.header&&E.length===0}function W(k,b,O,g){k={type:k,code:b,message:O},g!==void 0&&(k.row=g),o.errors.push(k)}w(e.step)&&(i=e.step,e.step=function(k){o=k,P()?L():(L(),o.data.length!==0&&(I+=k.data.length,e.preview&&I>e.preview?n.abort():(o.data=o.data[0],i(o,_))))}),this.parse=function(k,b,O){var g=e.quoteChar||'"',g=(e.newline||(e.newline=this.guessLineEndings(k,g)),s=!1,e.delimiter?w(e.delimiter)&&(e.delimiter=e.delimiter(k),o.meta.delimiter=e.delimiter):((g=((x,F,R,C,m)=>{var z,v,S,D;m=m||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var X=0;X<m.length;X++){for(var Q,se=m[X],N=0,$=0,M=0,U=(S=void 0,new ye({comments:C,delimiter:se,newline:F,preview:10}).parse(x)),V=0;V<U.data.length;V++)R&&T(U.data[V])?M++:(Q=U.data[V].length,$+=Q,S===void 0?S=Q:0<Q&&(N+=Math.abs(Q-S),S=Q));0<U.data.length&&($/=U.data.length-M),(v===void 0||N<=v)&&(D===void 0||D<$)&&1.99<$&&(v=N,z=se,D=$)}return{successful:!!(e.delimiter=z),bestDelimiter:z}})(k,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=g.bestDelimiter:(s=!0,e.delimiter=c.DefaultDelimiter),o.meta.delimiter=e.delimiter),Ee(e));return e.preview&&e.header&&g.preview++,t=k,n=new ye(g),o=n.parse(t,b,O),L(),j?{meta:{paused:!0}}:o||{meta:{paused:!1}}},this.paused=function(){return j},this.pause=function(){j=!0,n.abort(),t=w(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){_.streamer._halted?(j=!1,_.streamer.parseChunk(t,!0)):setTimeout(_.resume,3)},this.aborted=function(){return h},this.abort=function(){h=!0,n.abort(),o.meta.aborted=!0,w(e.complete)&&e.complete(o),t=""},this.guessLineEndings=function(x,g){x=x.substring(0,1048576);var g=new RegExp(ie(g)+"([^]*?)"+ie(g),"gm"),O=(x=x.replace(g,"")).split("\r"),g=x.split(`
`),x=1<g.length&&g[0].length<O[0].length;if(O.length===1||x)return`
`;for(var F=0,R=0;R<O.length;R++)O[R][0]===`
`&&F++;return F>=O.length/2?`\r
`:"\r"}}function ie(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ye(e){var t=(e=e||{}).delimiter,n=e.newline,s=e.comments,i=e.step,p=e.preview,A=e.fastMode,B=null,H=!1,_=e.quoteChar==null?'"':e.quoteChar,I=_;if(e.escapeChar!==void 0&&(I=e.escapeChar),(typeof t!="string"||-1<c.BAD_DELIMITERS.indexOf(t))&&(t=","),s===t)throw new Error("Comment character same as delimiter");s===!0?s="#":(typeof s!="string"||-1<c.BAD_DELIMITERS.indexOf(s))&&(s=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var l=0,j=!1;this.parse=function(h,E,o){if(typeof h!="string")throw new Error("Input must be a string");var T=h.length,L=t.length,P=n.length,W=s.length,k=w(i),b=[],O=[],g=[],x=l=0;if(!h)return N();if(A||A!==!1&&h.indexOf(_)===-1){for(var F=h.split(n),R=0;R<F.length;R++){if(g=F[R],l+=g.length,R!==F.length-1)l+=n.length;else if(o)return N();if(!s||g.substring(0,W)!==s){if(k){if(b=[],D(g.split(t)),$(),j)return N()}else D(g.split(t));if(p&&p<=R)return b=b.slice(0,p),N(!0)}}return N()}for(var C=h.indexOf(t,l),m=h.indexOf(n,l),z=new RegExp(ie(I)+ie(_),"g"),v=h.indexOf(_,l);;)if(h[l]===_)for(v=l,l++;;){if((v=h.indexOf(_,v+1))===-1)return o||O.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:l}),Q();if(v===T-1)return Q(h.substring(l,v).replace(z,_));if(_===I&&h[v+1]===I)v++;else if(_===I||v===0||h[v-1]!==I){C!==-1&&C<v+1&&(C=h.indexOf(t,v+1));var S=X((m=m!==-1&&m<v+1?h.indexOf(n,v+1):m)===-1?C:Math.min(C,m));if(h.substr(v+1+S,L)===t){g.push(h.substring(l,v).replace(z,_)),h[l=v+1+S+L]!==_&&(v=h.indexOf(_,l)),C=h.indexOf(t,l),m=h.indexOf(n,l);break}if(S=X(m),h.substring(v+1+S,v+1+S+P)===n){if(g.push(h.substring(l,v).replace(z,_)),se(v+1+S+P),C=h.indexOf(t,l),v=h.indexOf(_,l),k&&($(),j))return N();if(p&&b.length>=p)return N(!0);break}O.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:l}),v++}}else if(s&&g.length===0&&h.substring(l,l+W)===s){if(m===-1)return N();l=m+P,m=h.indexOf(n,l),C=h.indexOf(t,l)}else if(C!==-1&&(C<m||m===-1))g.push(h.substring(l,C)),l=C+L,C=h.indexOf(t,l);else{if(m===-1)break;if(g.push(h.substring(l,m)),se(m+P),k&&($(),j))return N();if(p&&b.length>=p)return N(!0)}return Q();function D(M){b.push(M),x=l}function X(M){var U=0;return U=M!==-1&&(M=h.substring(v+1,M))&&M.trim()===""?M.length:U}function Q(M){return o||(M===void 0&&(M=h.substring(l)),g.push(M),l=T,D(g),k&&$()),N()}function se(M){l=M,D(g),g=[],m=h.indexOf(n,l)}function N(M){if(e.header&&!E&&b.length&&!H){var U=b[0],V=Object.create(null),ke=new Set(U);let Se=!1;for(let ee=0;ee<U.length;ee++){let K=U[ee];if(V[K=w(e.transformHeader)?e.transformHeader(K,ee):K]){let oe,Ie=V[K];for(;oe=K+"_"+Ie,Ie++,ke.has(oe););ke.add(oe),U[ee]=oe,V[K]++,Se=!0,(B=B===null?{}:B)[oe]=K}else V[K]=1,U[ee]=K;ke.add(K)}Se&&console.warn("Duplicate headers found and renamed."),H=!0}return{data:b,errors:O,meta:{delimiter:t,linebreak:n,aborted:j,truncated:!!M,cursor:x+(E||0),renamedHeaders:B}}}function $(){i(N()),b=[],O=[]}},this.abort=function(){j=!0},this.getCharIndex=function(){return l}}function Fe(e){var t=e.data,n=le[t.workerId],s=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){s=!0,xe(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Re,resume:Re};if(w(n.userStep)){for(var p=0;p<t.results.data.length&&(n.userStep({data:t.results.data[p],errors:t.results.errors,meta:t.results.meta},i),!s);p++);delete t.results}else w(n.userChunk)&&(n.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!s&&xe(t.workerId,t.results)}function xe(e,t){var n=le[e];w(n.userComplete)&&n.userComplete(t),n.terminate(),delete le[e]}function Re(){throw new Error("Not implemented.")}function Ee(e){if(typeof e!="object"||e===null)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=Ee(e[t]);return n}function Z(e,t){return function(){e.apply(t,arguments)}}function w(e){return typeof e=="function"}return c.parse=function(e,t){var n=(t=t||{}).dynamicTyping||!1;if(w(n)&&(t.dynamicTypingFunction=n,n={}),t.dynamicTyping=n,t.transform=!!w(t.transform)&&t.transform,!t.worker||!c.WORKERS_SUPPORTED)return n=null,c.NODE_STREAM_INPUT,typeof e=="string"?(e=(s=>s.charCodeAt(0)!==65279?s:s.slice(1))(e),n=new(t.download?ce:re)(t)):e.readable===!0&&w(e.read)&&w(e.on)?n=new he(t):(a.File&&e instanceof File||e instanceof Object)&&(n=new de(t)),n.stream(e);(n=(()=>{var s;return!!c.WORKERS_SUPPORTED&&(s=(()=>{var i=a.URL||a.webkitURL||null,p=f.toString();return c.BLOB_URL||(c.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",p,")();"],{type:"text/javascript"})))})(),(s=new a.Worker(s)).onmessage=Fe,s.id=De++,le[s.id]=s)})()).userStep=t.step,n.userChunk=t.chunk,n.userComplete=t.complete,n.userError=t.error,t.step=w(t.step),t.chunk=w(t.chunk),t.complete=w(t.complete),t.error=w(t.error),delete t.worker,n.postMessage({input:e,config:t,workerId:n.id})},c.unparse=function(e,t){var n=!1,s=!0,i=",",p=`\r
`,A='"',B=A+A,H=!1,_=null,I=!1,l=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||c.BAD_DELIMITERS.filter(function(E){return t.delimiter.indexOf(E)!==-1}).length||(i=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(n=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(H=t.skipEmptyLines),typeof t.newline=="string"&&(p=t.newline),typeof t.quoteChar=="string"&&(A=t.quoteChar),typeof t.header=="boolean"&&(s=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");_=t.columns}t.escapeChar!==void 0&&(B=t.escapeChar+A),t.escapeFormulae instanceof RegExp?I=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(I=/^[=+\-@\t\r].*$/)}})(),new RegExp(ie(A),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return j(null,e,H);if(typeof e[0]=="object")return j(_||Object.keys(e[0]),e,H)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||_),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),j(e.fields||[],e.data||[],H);throw new Error("Unable to serialize unrecognized input");function j(E,o,T){var L="",P=(typeof E=="string"&&(E=JSON.parse(E)),typeof o=="string"&&(o=JSON.parse(o)),Array.isArray(E)&&0<E.length),W=!Array.isArray(o[0]);if(P&&s){for(var k=0;k<E.length;k++)0<k&&(L+=i),L+=h(E[k],k);0<o.length&&(L+=p)}for(var b=0;b<o.length;b++){var O=(P?E:o[b]).length,g=!1,x=P?Object.keys(o[b]).length===0:o[b].length===0;if(T&&!P&&(g=T==="greedy"?o[b].join("").trim()==="":o[b].length===1&&o[b][0].length===0),T==="greedy"&&P){for(var F=[],R=0;R<O;R++){var C=W?E[R]:R;F.push(o[b][C])}g=F.join("").trim()===""}if(!g){for(var m=0;m<O;m++){0<m&&!x&&(L+=i);var z=P&&W?E[m]:m;L+=h(o[b][z],m)}b<o.length-1&&(!T||0<O&&!x)&&(L+=p)}}return L}function h(E,o){var T,L;return E==null?"":E.constructor===Date?JSON.stringify(E).slice(1,25):(L=!1,I&&typeof E=="string"&&I.test(E)&&(E="'"+E,L=!0),T=E.toString().replace(l,B),(L=L||n===!0||typeof n=="function"&&n(E,o)||Array.isArray(n)&&n[o]||((P,W)=>{for(var k=0;k<W.length;k++)if(-1<P.indexOf(W[k]))return!0;return!1})(T,c.BAD_DELIMITERS)||-1<T.indexOf(i)||T.charAt(0)===" "||T.charAt(T.length-1)===" ")?A+T+A:T)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!d&&!!a.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=ye,c.ParserHandle=we,c.NetworkStreamer=ce,c.FileStreamer=de,c.StringStreamer=re,c.ReadableStreamStreamer=he,a.jQuery&&((u=a.jQuery).fn.parse=function(e){var t=e.config||{},n=[];return this.each(function(p){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&a.FileReader)||!this.files||this.files.length===0)return!0;for(var A=0;A<this.files.length;A++)n.push({file:this.files[A],inputElem:this,instanceConfig:u.extend({},t)})}),s(),this;function s(){if(n.length===0)w(e.complete)&&e.complete();else{var p,A,B,H,_=n[0];if(w(e.before)){var I=e.before(_.file,_.inputElem);if(typeof I=="object"){if(I.action==="abort")return p="AbortError",A=_.file,B=_.inputElem,H=I.reason,void(w(e.error)&&e.error({name:p},A,B,H));if(I.action==="skip")return void i();typeof I.config=="object"&&(_.instanceConfig=u.extend(_.instanceConfig,I.config))}else if(I==="skip")return void i()}var l=_.instanceConfig.complete;_.instanceConfig.complete=function(j){w(l)&&l(j,_.file,_.inputElem),i()},c.parse(_.file,_.instanceConfig)}}function i(){n.splice(0,1),s()}}),q&&(a.onmessage=function(e){e=e.data,c.WORKER_ID===void 0&&e&&(c.WORKER_ID=e.workerId),typeof e.input=="string"?a.postMessage({workerId:c.WORKER_ID,results:c.parse(e.input,e.config),finished:!0}):(a.File&&e.input instanceof File||e.input instanceof Object)&&(e=c.parse(e.input,e.config))&&a.postMessage({workerId:c.WORKER_ID,results:e,finished:!0})}),(ce.prototype=Object.create(J.prototype)).constructor=ce,(de.prototype=Object.create(J.prototype)).constructor=de,(re.prototype=Object.create(re.prototype)).constructor=re,(he.prototype=Object.create(J.prototype)).constructor=he,c})})(fe)),fe.exports}var je=Pe();const ze=Me(je);function Ne(r){return r==="true"}function Le(r,y=0){const f=parseInt(r,10);return isNaN(f)?y:f}function Ue(r){const y=[r.choice1,r.choice2,r.choice3,r.choice4,r.choice5].filter(f=>!!f&&f.trim().length>0);return{question:r.question,questionImage:r.questionImage??"",choices:y,shuffle:Ne(r.shuffle??"false"),correctAnswerIndex:Le(r.correctAnsIndex,1)-1,explanation:r.explanation,timeLimit:Le(r.timelimit,30)}}function Be(r,y){if(y>=r.length)return[...r];const f=new Set;for(;f.size<y;)f.add(Math.floor(Math.random()*r.length));return[...f].sort((a,u)=>a-u).map(a=>r[a])}async function He(r,y){return new Promise((f,a)=>{ze.parse(r,{download:!0,header:!0,skipEmptyLines:!0,complete:u=>{try{const d=u.data.map(Ue);if(d.length<=y)f(d);else{const q=Be(d,y);f(q)}}catch(d){a(d)}},error:a})})}let G,te=0,pe=0,be=0,ae=!1,me;const ge=document.createElement("h2"),_e=document.createElement("p"),ve=document.createElement("ul"),ue=document.createElement("p"),Ce=document.createElement("p"),Y=document.createElement("button"),ne=document.createElement("button");document.body.appendChild(ge);document.body.appendChild(_e);document.body.appendChild(ve);document.body.appendChild(ue);document.body.appendChild(Ce);document.body.appendChild(Y);document.body.appendChild(ne);ne.textContent="クイズ開始";ne.style.display="none";ne.addEventListener("click",()=>{ne.style.display="none",Ae()});Y.textContent="次の問題へ";Y.style.display="none";Y.addEventListener("click",()=>{te+=1,Y.style.display="none",Ce.textContent="",ue.textContent="",Ae()});function We(r,y){const f=[...r];let a=r[y];for(let d=f.length-1;d>0;d--){const q=Math.floor(Math.random()*(d+1));[f[d],f[q]]=[f[q],f[d]]}const u=f.findIndex(d=>d===a);return[f,u]}function Qe(r){return new Promise((y,f)=>{const a=document.createElement("img");a.src=r,a.alt="問題画像",a.style.maxWidth="100%",a.style.display="block",a.onload=()=>y(a),a.onerror=u=>f(u)})}async function Ae(){console.log("render",te);const r=G[te];console.log("debug:",r.choices,r.correctAnswerIndex);let y=r.choices,f=r.correctAnswerIndex;r.shuffle&&([y,f]=We(r.choices,r.correctAnswerIndex)),console.log(y,f),ge.innerHTML="",_e.textContent=`残り時間: ${r.timeLimit}秒`;const a=document.createElement("span");if(a.textContent=`Q${te+1}: ${r.question}`,ge.appendChild(a),r.questionImage)try{const u=await Qe(r.questionImage),d=document.createElement("div");d.style.textAlign="center",d.style.width="100%",d.style.marginTop="15px",u.style.maxWidth="100%",u.style.height="auto",u.style.display="inline-block",d.appendChild(u),ge.appendChild(d)}catch(u){console.error("画像の読み込みに失敗しました",u)}ve.innerHTML="",y.forEach((u,d)=>{const q=document.createElement("li");q.textContent=u,q.className="choice",q.addEventListener("click",()=>Ve(d,f,y)),ve.appendChild(q)}),Ke(r.timeLimit,y,f),ae=!1}function $e(){document.body.innerHTML="";const r=document.createElement("div");r.innerHTML=`
        <h2>成績発表 🎓</h2>
        <p>全 ${G.length} 問中、${be} 問正解！</p>
        <p>正答率: ${(be/G.length*100).toFixed(1)}%</p>
        <button id="retryBtn">もう一度</button>
    `,document.body.appendChild(r),document.getElementById("retryBtn")?.addEventListener("click",()=>{location.reload()})}function Ke(r,y,f){pe=r,me=setInterval(()=>{pe-=1,Je(),pe<0&&(clearInterval(me),Ze(f,y))},1e3)}function Je(){_e.textContent=`残り時間: ${pe}秒`}function Ve(r,y,f){if(me!==null&&clearInterval(me),ae==!0)return;ae=!0,document.querySelectorAll(".choice").forEach((u,d)=>{u.classList.remove("correct","incorrect"),d===y?u.classList.add("correct"):d===r&&u.classList.add("incorrect")}),r===y?(be+=1,ue.textContent="正解！🎉"):ue.textContent=`不正解。正解は「${f[y]}」です`,Te()}function Ze(r,y){if(ae==!0)return;ae=!0,document.querySelectorAll(".choice").forEach((a,u)=>{a.classList.remove("correct","incorrect"),u===r&&a.classList.add("correct")}),ue.textContent=`時間切れ！ 正解は「${y[r]}」です`,Te()}function Te(){if(_e.textContent="　",Ce.textContent=G[te].explanation,te<G.length-1)Y.style.display="inline-block";else{const r=Y.cloneNode(!0);Y.replaceWith(r),r.textContent="成績を見る",r.style.display="inline-block",r.addEventListener("click",()=>$e())}}async function Ge(){const r=new URLSearchParams(window.location.search),y=r.get("docId"),f=parseInt(r.get("qnum")??"10",10);if(!y){console.error("docIdが指定されていません。?docId=xxx を指定してください。");return}const a="https://docs.google.com/spreadsheets/d/"+y+"/export?format=csv&gid=0";try{G=await He(a,f),console.log("読み込んだ問題:",G),G.length&&(ne.style.display="inline-block")}catch(u){console.error("CSV の読み込みに失敗しました:",u)}}Ge();
